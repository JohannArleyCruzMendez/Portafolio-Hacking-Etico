# Pr√°ctica 2.4: Rastreo de Redes con Wireshark

## üéØ Objetivo
Capturar y analizar tr√°fico de red en tiempo real para comprender los riesgos de los protocolos no cifrados. Se utiliz√≥ **tcpdump** para la captura en l√≠nea de comandos y **Wireshark** para el an√°lisis profundo de paquetes (Deep Packet Inspection), enfoc√°ndose en la extracci√≥n de informaci√≥n sensible como credenciales y tokens de sesi√≥n.

## üõ†Ô∏è Herramientas Utilizadas
* **Tcpdump:** Captura ligera de paquetes desde la terminal.
* **Wireshark:** An√°lisis gr√°fico de protocolos y filtrado de tr√°fico.
* **DVWA (Damn Vulnerable Web App):** Entorno de pruebas web vulnerable.

## üìù Desarrollo de la Pr√°ctica

### 1. Reconocimiento de Entorno y Captura CLI
Antes de interceptar tr√°fico, se identificaron los par√°metros de red de la m√°quina atacante (Kali Linux) para distinguir el tr√°fico propio del ajeno.
* **Interfaz:** `eth0` (Salida a Internet) y `br-internal` (Red interna vulnerable).
* **Captura:** Se utiliz√≥ `sudo tcpdump -i eth0 -s 0 -w packetdump.pcap` para grabar todo el tr√°fico de navegaci√≥n hacia un archivo para su an√°lisis forense posterior.

### 2. An√°lisis de Tr√°fico DNS (Privacidad)
Al analizar la captura en Wireshark filtrando por `dns`, se evidenci√≥ que las consultas de nombres de dominio viajan en texto plano, revelando el historial de navegaci√≥n del usuario.
* **Hallazgo:** Se identificaron peticiones a `google.com`, `mozilla.org` y `netacad.com`.
* **Correlaci√≥n:** Se verific√≥ que la direcci√≥n MAC de origen en la trama Ethernet coincid√≠a con la de la m√°quina atacante (`08:00:27:4a:f3:6e`), confirmando la autor√≠a del tr√°fico.
* **Resoluci√≥n:** Se determin√≥ que el dominio `cisco.com` / `netacad.com` resolv√≠a a la IP p√∫blica **23.2.68.112** (v√≠a CDN Akamai).

### 3. Intercepci√≥n de Credenciales (HTTP Cleartext)
Se realiz√≥ un ataque de "Sniffing" en la red interna (`10.8.68.0/24`) contra un servidor web vulnerable (DVWA) que no implementa SSL/TLS.
* **Filtro:** `http.request.method == POST`
* **An√°lisis:** Al inspeccionar la carga √∫til del formulario HTML (`application/x-www-form-urlencoded`), se obtuvieron las credenciales de administraci√≥n en texto plano:
    * **Usuario:** `admin`
    * **Contrase√±a:** `password`
* **Impacto:** Compromiso total de la cuenta debido a la falta de cifrado en tr√°nsito.

### 4. Secuestro de Sesi√≥n (Session Hijacking)
M√°s all√° de las credenciales, se analiz√≥ el mecanismo de persistencia de sesi√≥n del servidor.
* **Filtro:** `http.cookie` o an√°lisis del flujo TCP.
* **Hallazgo:** Se extrajo la cookie de sesi√≥n PHP activa:
    > `PHPSESSID=88d3la6sq0ajhf3074vs7hp084`
* **Impacto:** Un atacante con acceso a este token puede realizar **Session Hijacking** (suplantaci√≥n de identidad) sin necesidad de conocer el usuario o la contrase√±a, accediendo directamente a la cuenta de la v√≠ctima.

## üöÄ Conclusiones
1.  **Visibilidad Total:** Wireshark permite reconstruir flujos completos de comunicaci√≥n. Protocolos como HTTP, Telnet o FTP son inherentemente inseguros y no deben usarse en entornos de producci√≥n.
2.  **La Importancia de HTTPS:** El cifrado (SSL/TLS) es la √∫nica barrera efectiva contra el sniffing pasivo en redes locales.
3.  **Rastro Digital:** Incluso sin desencriptar el tr√°fico HTTPS, el an√°lisis de metadatos (DNS, SNI en TLS) permite perfilar el comportamiento de un usuario.
